<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0,minimal-ui:ios">
    <title>API Document</title>
    <link href="css/backend.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/index.css">
    <script src="js/jquery.min.js" type="text/javascript"></script>
    <script src="js/layer.min.js" type="text/javascript"></script>
    <script src="wordexport/FileSaver.js" type="text/javascript"></script>
    <script src="wordexport/jquery.wordexport.js" type="text/javascript"></script>
</head>

<body>
    <div class="header">
        <div>
            <img class="logo" src="image/API.png" alt="">
            <span class="title">API DOC</span>
            <p class="rigInput inBlock">
                <input type="text" placeholder="http://example.com/api" id="url">
                <input type="text" placeholder="api_key" id="apiKey">
                <button id="searchBtn" class="search">查找</button>
                <button id="exportBtn" class="export">导出至word</button>
            </p>
        </div>
    </div>
    <div class="bodyPart box-section">
        <div>
            <ul class="moduleList">
                <li>
                    <div>
                        <span class="subTit">abcd</span>
                        <p class="operaBtnPart inBlock fRig">
                            <button class="showOrhide">显示/隐藏</button>
                            <button class="showOperaOrhideOpera">展开/隐藏操作</button>
                        </p>
                    </div>
                    <ul class="slideList">
                    </ul>
                </li>

            </ul>
        </div>
    </div>
    <!--导出模板-->
    <script type="text/template" id="templexport">
        <div class="table-responsive" id="ReportToWord">
            <table class="table data-table table-striped table-bordered">
                <thead>
                    <tr><th width="10%">模块名称</th><th width="10%">方法</th><th width="10%">请求方式</th><th width="10%">说明</th><th width="10%">参数</th></tr>
                </thead>
                <tbody>
                    [content]
                </tbody>
            </table>
        </div>
    </script>
    <script src="js/index.js"></script>
    <script type="text/javascript">
        $(function () {
            //导出word，生成模板内容
            $(document).on("click", "#exportBtn", function (e) {
                var routelist = $(".moduleList .resource");
                var table_tbody = "";
                $.each(routelist, function (i, model) {
                    var subFunctin = $(model).find(".operation");//方法列表
                    var roueName = $(model).find(".routename").text();
                    $.each(subFunctin, function (ii, fun) {
                        var m = $(fun).find(".httpMethod").text(), t = $(fun).find(".tableParameters"),
                            obj = {
                                rowspan: subFunctin.length, roueName: roueName, MethodName: $(fun).find(".routepath").text(), Method: m, Options: $(fun).find(".httpOptions").text(), "Parameters": m.toUpperCase() == "POST" ? $(fun).find(".examBox").text() : getParams = function () { var str = ""; $.each(t.find("tbody > tr"), function (tt, tr) { str += $(tr).find("td:eq(0)").text() + ":" + $(tr).find("td:eq(2)").text() + "," }); return str; }
                            }
                        ii == 0 ? table_tbody += strFormat("<tr><td rowspan='{rowspan}'>{roueName}</td><td>{MethodName}</td><td>{Method}</td><td>{Options}</td><td>{Parameters}</td></tr>", obj) : table_tbody += strFormat("<tr><td>{MethodName}</td><td>{Method}</td><td>{Options}</td><td>{Parameters}</td></tr>", obj);
                    });
                })
                var templ = $("#templexport").html();
                templ = templ.replace("[content]", table_tbody);
                var _height = document.documentElement.clientHeight || $(window).height();
                var _width = document.documentElement.clientWidth || $(window).width();
                _width = _width < 800 ? _width : _width * 0.5;
                var layerindex = layer.open({
                    type: 1,
                    title: "api 接口文档",
                    area: [_width + 'px', (_height - 100) + 'px'],
                    content: templ,
                    btn: ['立即导出', '关闭'],
                    yes: function (index) {
                        var cssTxt = ".table{width:100%;margin-bottom:1rem;color:#535f6b}.table td,.table th{padding:.75rem;vertical-align:top;border-top:1px solid #f1f1f1}.table thead th{vertical-align:bottom;border-bottom:2px solid #f1f1f1;background: rgb(218,227,243);}.table tbody+tbody{border-top:2px solid #f1f1f1}.table-sm td,.table-sm th{padding:.3rem}.table-bordered td,.table-bordered th{border:1px solid #f1f1f1}.table-bordered thead td,.table-bordered thead th{border-bottom-width:2px}.table-borderless tbody+tbody,.table-borderless td,.table-borderless th,.table-borderless thead th{border:0}.table-striped tbody tr:nth-of-type(odd){background-color:rgba(0,0,0,.05)}.table-hover tbody tr:hover{color:#535f6b;background-color:rgba(0,0,0,.075)}table.dataTable{width:100%;margin:0 auto;clear:both;border-collapse:separate;border-spacing:0}table.dataTable tfoot th,table.dataTable thead th{font-weight:700}table.dataTable thead td,table.dataTable thead th{padding:10px 18px;border-bottom:1px solid #111}table.dataTable thead td:active,table.dataTable thead th:active{outline:none}table.dataTable tfoot td,table.dataTable tfoot th{padding:10px 18px 6px;border-top:1px solid #111}table.dataTable tbody tr{background-color:#fff}table.dataTable tbody tr.selected{background-color:#b0bed9}table.dataTable tbody td,table.dataTable tbody th{padding:8px 10px}table.dataTable.display tbody td,table.dataTable.display tbody th,table.dataTable.row-border tbody td,table.dataTable.row-border tbody th{border-top:1px solid #ddd}table.dataTable.display tbody tr:first-child td,table.dataTable.display tbody tr:first-child th,table.dataTable.row-border tbody tr:first-child td,table.dataTable.row-border tbody tr:first-child th{border-top:none}table.dataTable.cell-border tbody td,table.dataTable.cell-border tbody th{border-top:1px solid #ddd;border-right:1px solid #ddd}table.dataTable.cell-border tbody tr td:first-child,table.dataTable.cell-border tbody tr th:first-child{border-left:1px solid #ddd}table.dataTable.cell-border tbody tr:first-child td,table.dataTable.cell-border tbody tr:first-child th{border-top:none}table.dataTable.display tbody tr.odd,table.dataTable.stripe tbody tr.odd{background-color:#f9f9f9}table.dataTable.display tbody tr.odd.selected,table.dataTable.stripe tbody tr.odd.selected{background-color:#acbad4}table.dataTable.display tbody tr:hover,table.dataTable.hover tbody tr:hover{background-color:#f6f6f6}table.dataTable.display tbody tr:hover.selected,table.dataTable.hover tbody tr:hover.selected{background-color:#aab7d1}table.dataTable td.dt-left,table.dataTable th.dt-left{text-align:left}table.dataTable td.dataTables_empty,table.dataTable td.dt-center,table.dataTable th.dt-center{text-align:center}table.dataTable td.dt-right,table.dataTable th.dt-right{text-align:right}table.dataTable td.dt-justify,table.dataTable th.dt-justify{text-align:justify}table.dataTable td.dt-nowrap,table.dataTable th.dt-nowrap{white-space:nowrap}table.dataTable tfoot td.dt-head-left,table.dataTable tfoot th.dt-head-left,table.dataTable thead td.dt-head-left,table.dataTable thead th.dt-head-left{text-align:left}table.dataTable tfoot td.dt-head-center,table.dataTable tfoot th.dt-head-center,table.dataTable thead td.dt-head-center,table.dataTable thead th.dt-head-center{text-align:center}table.dataTable tfoot td.dt-head-right,table.dataTable tfoot th.dt-head-right,table.dataTable thead td.dt-head-right,table.dataTable thead th.dt-head-right{text-align:right}table.dataTable tfoot td.dt-head-justify,table.dataTable tfoot th.dt-head-justify,table.dataTable thead td.dt-head-justify,table.dataTable thead th.dt-head-justify{text-align:justify}table.dataTable tfoot td.dt-head-nowrap,table.dataTable tfoot th.dt-head-nowrap,table.dataTable thead td.dt-head-nowrap,table.dataTable thead th.dt-head-nowrap{white-space:nowrap}table.dataTable tbody td.dt-body-left,table.dataTable tbody th.dt-body-left{text-align:left}table.dataTable tbody td.dt-body-center,table.dataTable tbody th.dt-body-center{text-align:center}table.dataTable tbody td.dt-body-right,table.dataTable tbody th.dt-body-right{text-align:right}table.dataTable tbody td.dt-body-justify,table.dataTable tbody th.dt-body-justify{text-align:justify}table.dataTable tbody td.dt-body-nowrap,table.dataTable tbody th.dt-body-nowrap{white-space:nowrap}table.dataTable,table.dataTable td,table.dataTable th{box-sizing:content-box}.dataTables_wrapper{position:relative;clear:both;*zoom:1;zoom:1}";
                        //按钮【按钮一】的回调
                        $('#ReportToWord').wordExport("api 接口文档", cssTxt);
                        return;
                    },
                    btn2: function (index, layero) {
                        //按钮【按钮二】的回调
                        layer.close(layerindex);//关闭弹框
                    },
                })
            })
            strFormat = function (str, obj) {
                if (typeof obj == "object") {
                    for (var attr in obj) {
                        str = str.replace("{" + attr + "}", obj[attr]);
                    }
                } else {
                    //var a = arguments;
                    //alert(a instanceof Array)==》false
                    //把参数放到数组里面 slice() 方法可从已有的数组中返回选定的元素。
                    var arr = [].slice.call(arguments, 1);
                    //调用自己
                    return strFormat(str, arr);
                }
                return str;
            }
        })
    </script>
</body>
</html>